<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Strict//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>F:\java\GitApp\Dokky\dokky\meeting\taewon\.10.2~10.8리뷰.md.html</title>


<style type="text/css">
body {
	color: #333;
	font: 13px/1.4 "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif;
	padding: 0;
	margin: 0;
}

a {
	background: transparent;
	color: #4183c4;
	text-decoration: none;
}

a:active,
a:hover {
	outline: 0 none;
	text-decoration: underline;
}

abbr[title] {
	border-bottom: 1px dotted;
}

b,
strong {
	font-weight: bold;
}

dfn {
	font-style: italic;
}
h1 {
	font-size: 2em;
	margin: 0.67em 0;
}
mark {
	background: #ff0;
	color: #000;
}
small {
	font-size: 80%;
}
sub, sup {
	font-size: 75%;
	line-height: 0;
	position: relative;
	vertical-align: baseline;
}
sup {
	top: -0.5em;
}
sub {
	bottom: -0.25em;
}
img {
	border: 0 none;
}
svg:not(:root) {
	overflow: hidden;
}
figure {
	margin: 1em 40px;
}
hr {
	box-sizing: content-box;
	height: 0;
}

code,
kbd,
pre,
samp {
	font-family: monospace,monospace;
	font-size: 1em;
}

pre {
	overflow: auto;
	font: 12px Consolas,"Liberation Mono",Menlo,Courier,monospace;
	margin-bottom: 0;
	margin-top: 0;
}

.markdown-body {
	padding: 30px;
	font-size: 16px;
	line-height: 1.6;
	word-wrap: break-word;
}

.markdown-body>*:first-child {
	margin-top: 0 !important;
}

.markdown-body>*:last-child {
	margin-bottom: 0 !important;
}

.markdown-body .absent {
	color: #c00;
}

.markdown-body .anchor {
	position: absolute;
	top: 0;
	bottom: 0;
	left: 0;
	display: block;
	padding-right: 6px;
	padding-left: 30px;
	margin-left: -30px;
}

.markdown-body .anchor:focus {
	outline: none;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
	position: relative;
	margin-top: 1em;
	margin-bottom: 16px;
	font-weight: bold;
	line-height: 1.4;
}

.markdown-body h1 .octicon-link,
.markdown-body h2 .octicon-link,
.markdown-body h3 .octicon-link,
.markdown-body h4 .octicon-link,
.markdown-body h5 .octicon-link,
.markdown-body h6 .octicon-link {
	display: none;
	color: #000;
	vertical-align: middle;
}

.markdown-body h1:hover .anchor,
.markdown-body h2:hover .anchor,
.markdown-body h3:hover .anchor,
.markdown-body h4:hover .anchor,
.markdown-body h5:hover .anchor,
.markdown-body h6:hover .anchor {
	padding-left: 8px;
	margin-left: -30px;
	line-height: 1;
	text-decoration: none;
}

.markdown-body h1:hover .anchor .octicon-link,
.markdown-body h2:hover .anchor .octicon-link,
.markdown-body h3:hover .anchor .octicon-link,
.markdown-body h4:hover .anchor .octicon-link,
.markdown-body h5:hover .anchor .octicon-link,
.markdown-body h6:hover .anchor .octicon-link {
	display: inline-block;
}

.markdown-body h1 tt,
.markdown-body h1 code,
.markdown-body h2 tt,
.markdown-body h2 code,
.markdown-body h3 tt,
.markdown-body h3 code,
.markdown-body h4 tt,
.markdown-body h4 code,
.markdown-body h5 tt,
.markdown-body h5 code,
.markdown-body h6 tt,
.markdown-body h6 code {
	font-size: inherit;
}

.markdown-body h1 {
	padding-bottom: 0.3em;
	font-size: 2.25em;
	line-height: 1.2;
	border-bottom: 1px solid #eee;
}

.markdown-body h2 {
	padding-bottom: 0.3em;
	font-size: 1.75em;
	line-height: 1.225;
	border-bottom: 1px solid #eee;
}

.markdown-body h3 {
	font-size: 1.5em;
	line-height: 1.43;
}

.markdown-body h4 {
	font-size: 1.25em;
}

.markdown-body h5 {
	font-size: 1em;
}

.markdown-body h6 {
	font-size: 1em;
	color: #777;
}

.markdown-body p,.markdown-body blockquote,
.markdown-body ul,.markdown-body ol,
.markdown-body dl,.markdown-body table,
.markdown-body pre {
	margin-top: 0;
	margin-bottom: 16px;
}

.markdown-body hr {
	height: 4px;
	padding: 0;
	margin: 16px 0;
	background-color: #e7e7e7;
	border: 0 none;
}

.markdown-body ul,
.markdown-body ol {
	padding-left: 2em;
}

.markdown-body ul.no-list,
.markdown-body ol.no-list {
	padding: 0;
	list-style-type: none;
}

.markdown-body ul ul,
.markdown-body ul ol,
.markdown-body ol ol,
.markdown-body ol ul {
	margin-top: 0;
	margin-bottom: 0;
}

.markdown-body li>p {
	margin-top: 16px;
}

.markdown-body dl {
	padding: 0;
}

.markdown-body dl dt {
	padding: 0;
	margin-top: 16px;
	font-size: 1em;
	font-style: italic;
	font-weight: bold;
}

.markdown-body dl dd {
	padding: 0 16px;
	margin-bottom: 16px;
}

.markdown-body blockquote {
	padding: 0 15px;
	color: #777;
	border-left: 4px solid #ddd;
}

.markdown-body blockquote>:first-child {
	margin-top: 0;
}

.markdown-body blockquote>:last-child {
	margin-bottom: 0;
}

.markdown-body table {
	display: block;
	width: 100%;
	overflow: auto;
	word-break: normal;
	word-break: keep-all;
}

.markdown-body table th {
	font-weight: bold;
}

.markdown-body table th,
.markdown-body table td {
	padding: 6px 13px;
	border: 1px solid #ddd;
}

.markdown-body table tr {
	background-color: #fff;
	border-top: 1px solid #ccc;
}

.markdown-body table tr:nth-child(2n) {
	background-color: #f8f8f8;
}

.markdown-body img {
	max-width: 100%;
	-moz-box-sizing: border-box;
	box-sizing: border-box;
}

.markdown-body span.frame {
	display: block;
	overflow: hidden;
}

.markdown-body span.frame>span {
	display: block;
	float: left;
	width: auto;
	padding: 7px;
	margin: 13px 0 0;
	overflow: hidden;
	border: 1px solid #ddd;
}

.markdown-body span.frame span img {
	display: block;
	float: left;
}

.markdown-body span.frame span span {
	display: block;
	padding: 5px 0 0;
	clear: both;
	color: #333;
}

.markdown-body span.align-center {
	display: block;
	overflow: hidden;
	clear: both;
}

.markdown-body span.align-center>span {
	display: block;
	margin: 13px auto 0;
	overflow: hidden;
	text-align: center;
}

.markdown-body span.align-center span img {
	margin: 0 auto;
	text-align: center;
}

.markdown-body span.align-right {
	display: block;
	overflow: hidden;
	clear: both;
}

.markdown-body span.align-right>span {
	display: block;
	margin: 13px 0 0;
	overflow: hidden;
	text-align: right;
}

.markdown-body span.align-right span img {
	margin: 0;
	text-align: right;
}

.markdown-body span.float-left {
	display: block;
	float: left;
	margin-right: 13px;
	overflow: hidden;
}

.markdown-body span.float-left span {
	margin: 13px 0 0;
}

.markdown-body span.float-right {
	display: block;
	float: right;
	margin-left: 13px;
	overflow: hidden;
}

.markdown-body span.float-right>span {
	display: block;
	margin: 13px auto 0;
	overflow: hidden;
	text-align: right;
}

.markdown-body code,.markdown-body tt {
	padding: 0;
	padding-top: 0.2em;
	padding-bottom: 0.2em;
	margin: 0;
	font-size: 85%;
	background-color: rgba(0,0,0,0.04);
	border-radius: 3px;
}

.markdown-body code:before,
.markdown-body code:after,
.markdown-body tt:before,
.markdown-body tt:after {
	letter-spacing: -0.2em;
	content: "\00a0";
}

.markdown-body code br,
.markdown-body tt br {
	display: none;
}

.markdown-body del code {
	text-decoration: inherit;
}

.markdown-body pre>code {
	padding: 0;
	margin: 0;
	font-size: 100%;
	word-break: normal;
	white-space: pre;
	background: transparent;
	border: 0;
}

.markdown-body .highlight {
	margin-bottom: 16px;
}

.markdown-body .highlight pre,
.markdown-body pre {
	padding: 16px;
	overflow: auto;
	font-size: 85%;
	line-height: 1.45;
	background-color: #f7f7f7;
	border-radius: 3px;
}

.markdown-body .highlight pre {
	margin-bottom: 0;
	word-break: normal;
}

.markdown-body pre {
	word-wrap: normal;
}

.markdown-body pre code,
.markdown-body pre tt {
	display: inline;
	max-width: initial;
	padding: 0;
	margin: 0;
	overflow: initial;
	line-height: inherit;
	word-wrap: normal;
	background-color: transparent;
	border: 0;
}

.markdown-body pre code:before,
.markdown-body pre code:after,
.markdown-body pre tt:before,
.markdown-body pre tt:after {
	content: normal;
}

.highlight .pl-coc,
.highlight .pl-entl,
.highlight .pl-entm,
.highlight .pl-eoa,
.highlight .pl-mai .pl-sf,
.highlight .pl-mm,
.highlight .pl-pdv,
.highlight .pl-sc,
.highlight .pl-som,
.highlight .pl-sr,
.highlight .pl-v,
.highlight .pl-vpf {
	color: #0086b3;
}
.highlight .pl-eoac,
.highlight .pl-mdht,
.highlight .pl-mi1,
.highlight .pl-mri,
.highlight .pl-va,
.highlight .pl-vpu {
	color: #008080;
}
.highlight .pl-c,
.highlight .pl-pdc {
	color: #b4b7b4;
	font-style: italic;
}
.highlight .pl-k,
.highlight .pl-ko,
.highlight .pl-kolp,
.highlight .pl-mc,
.highlight .pl-mr,
.highlight .pl-ms,
.highlight .pl-s,
.highlight .pl-sok,
.highlight .pl-st {
	color: #6e5494;
}
.highlight .pl-ef,
.highlight .pl-enf,
.highlight .pl-enm,
.highlight .pl-entc,
.highlight .pl-eoi,
.highlight .pl-sf,
.highlight .pl-smc {
	color: #d12089;
}
.highlight .pl-ens,
.highlight .pl-eoai,
.highlight .pl-kos,
.highlight .pl-mh .pl-pdh,
.highlight .pl-mp,
.highlight .pl-pde,
.highlight .pl-stp {
	color: #458;
}
.highlight .pl-enti {
	color: #d12089;
	font-weight: bold;
}
.highlight .pl-cce,
.highlight .pl-enc,
.highlight .pl-kou,
.highlight .pl-mq {
	color: #f93;
}
.highlight .pl-mp1 .pl-sf {
	color: #458;
	font-weight: bold;
}
.highlight .pl-cos,
.highlight .pl-ent,
.highlight .pl-md,
.highlight .pl-mdhf,
.highlight .pl-ml,
.highlight .pl-pdc1,
.highlight .pl-pds,
.highlight .pl-s1,
.highlight .pl-scp,
.highlight .pl-sol {
	color: #df5000;
}
.highlight .pl-c1,
.highlight .pl-cn,
.highlight .pl-pse,
.highlight .pl-pse .pl-s2,
.highlight .pl-vi {
	color: #a31515;
}
.highlight .pl-mb,
.highlight .pl-pdb {
	color: #df5000;
	font-weight: bold;
}
.highlight .pl-mi,
.highlight .pl-pdi {
	color: #6e5494;
	font-style: italic;
}
.highlight .pl-ms1 {
	background-color: #f5f5f5;
}
.highlight .pl-mdh,
.highlight .pl-mdi {
	font-weight: bold;
}
.highlight .pl-mdr {
	color: #0086b3;
	font-weight: bold;
}
.highlight .pl-s2 {
	color: #333;
}
.highlight .pl-ii {
	background-color: #df5000;
	color: #fff;
}
.highlight .pl-ib {
	background-color: #f93;
}
.highlight .pl-id {
	background-color: #a31515;
	color: #fff;
}
.highlight .pl-iu {
	background-color: #b4b7b4;
}
.highlight .pl-mo {
	color: #969896;
}

</style>


<script type="text/javascript">

function getDocumentScrollTop() 
{
   var res = document.body.scrollTop || document.documentElement.scrollTop || window.pageYOffset || 0;
   // alert(res);
   return res;
}

function setDocumentScrollTop(ypos) 
{
	window.scrollTo(0, ypos);
}

</script>


</head>
<body class="markdown-body">
<h2> <a id="1-한주간-진행하였던-것들" class="anchor" href="#1-%ED%95%9C%EC%A3%BC%EA%B0%84-%EC%A7%84%ED%96%89%ED%95%98%EC%98%80%EB%8D%98-%EA%B2%83%EB%93%A4" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>1. 한주간 진행하였던 것들</h2> 
<ul> 
 <li> <p>AWS 계정 MFA활성화 정상 작동 확인</p> </li> 
 <li> <p>RDS 프리티어 재생성시 계속된 막힘 문제</p> </li> 
 <li> <p>S3를 활용한 업로드,다운로드 구현중</p> </li> 
</ul> 
<h2> <a id="2-진행중-겪었던-모든것들" class="anchor" href="#2-%EC%A7%84%ED%96%89%EC%A4%91-%EA%B2%AA%EC%97%88%EB%8D%98-%EB%AA%A8%EB%93%A0%EA%B2%83%EB%93%A4" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>2. 진행중 겪었던 모든것들</h2> 
<h3> <a id="1-html-a태그에서-파일을-다운로드할때-이름을-변경할수-없을까" class="anchor" href="#1-html-a%ED%83%9C%EA%B7%B8%EC%97%90%EC%84%9C-%ED%8C%8C%EC%9D%BC%EC%9D%84-%EB%8B%A4%EC%9A%B4%EB%A1%9C%EB%93%9C%ED%95%A0%EB%95%8C-%EC%9D%B4%EB%A6%84%EC%9D%84-%EB%B3%80%EA%B2%BD%ED%95%A0%EC%88%98-%EC%97%86%EC%9D%84%EA%B9%8C" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>1) html a태그에서 파일을 다운로드할때 이름을 변경할수 없을까..?</h3> 
<p>파일이 uuid 로 이름이 변경되어 저장되있어서 다운로드시 다시 원본이름으로 되돌려줘야 하는문제가 있는데..</p> 
<p>s3에서 다운로드 하는 가장 쉬운 첫번째 방법은 s3로 업로드된 파일의 링크를 얻어서 다운로드하는것인데</p> 
<p>이 링크를 a태그 href속성에 입력시켜주면 파일의 원본이름을 가져올수 없다는것이다..</p> 
<p>a태그의 download 속성값에 download=&quot;dokky.png&quot; 라고 넣어주면 이름이 변경된다고 하는데 소용이없다..</p> 
<p><a href="https://picksell-bucket.s3.ap-northeast-2.amazonaws.com/upload/2019/10/08/0a38de9a-5d3a-463b-8319-377c821de9d9_dokky.png" rel="nofollow">다운로드</a></p> 
<p><a href="https://picksell-bucket.s3.ap-northeast-2.amazonaws.com/upload/2019/10/08/0a38de9a-5d3a-463b-8319-377c821de9d9_dokky.png" rel="nofollow">https://picksell-bucket.s3.ap-northeast-2.amazonaws.com/upload/2019/10/08/0a38de9a-5d3a-463b-8319-377c821de9d9_dokky.png</a>&quot; download=&quot;dokky.png&quot;</p> 
<h3> <a id="2-퍼블릭프라이빗-접근의-복잡한설정문제" class="anchor" href="#2-%ED%8D%BC%EB%B8%94%EB%A6%AD%ED%94%84%EB%9D%BC%EC%9D%B4%EB%B9%97-%EC%A0%91%EA%B7%BC%EC%9D%98-%EB%B3%B5%EC%9E%A1%ED%95%9C%EC%84%A4%EC%A0%95%EB%AC%B8%EC%A0%9C" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>2) 퍼블릭,프라이빗 접근의 복잡한..설정문제..</h3> 
<p>s3에서 업로드와 다운로드를 할때 로그인한 회원에게만 파일 업로드와 다운로드를 제공하고싶다.</p> 
<p>왜냐하면 아무나 외부에서 대량 요청시(다운로드,업로드) 서버 과금발생을 막기 위해서인데,</p> 
<p>이 설정을 제대로 잡는게 굉장히 복잡하고 진입하기 어렵다..</p> 
<p>업로드의 경우///////////////////////////////////////////////////</p> 
<p>ec2에서 s3로 업로드를 할때 aws계정 인증이 기본적으로 필요하다</p> 
<p>첫번째 방법은 : aws루투 계정에서 하위 사용자(s3의 모든 관리 권한이 부여된)의 계정을 생성한다.</p> 
<p>그리고 업로드전 자바 코드안에 이 사용자의 Access key ID와 Secret access key를 입력하여 증명을 한다.</p> 
<p>하지만 이 방법이 느낌상 좋지않다. 코드안에 중요한 아이디와 비밀번호가 들어간다는것 자체부터..좋지않다.</p> 
<p>두번재 방법은: IAM 역할이라는 것이있는데, 이 하나의 역할에 정책(AmazonS3FullAccess)을 만들고 이 역할을 EC2에 적용해준다.</p> 
<p>그러면 ec2에서 s3로 접근할시에는 s3의 모든 관리 권한을 EC2는 부여받는것이다.</p> 
<p>이렇게 되면 굳이 사용자라는것을 안만들어도, Access key ID와 Secret access key를 코드상에 입력하지 않아도, s3의 관리 권한을 가진다고 알고있다.</p> 
<p>그래서 IAM 역할을 EC2에 적용까지 해놓았는데 빌드가 계속 실패되서 테스트를 못하고있다..현재는 사용자로 접속해서 하는중..</p> 
<p>다운로드의 경우 ///////////////////////////////////////////////////</p> 
<p>첫번째 : 링크를 받아서 다운받게 되면</p> 
<p>문제점 1. 파일의 이름변경을 못한다. 문제점 2. 퍼블릭으로 아무나 접근해서 다운받을수있다. 이걸어떻게 못막는것인가..</p> 
<p>두번째: 업로드처럼 EC2에 IAM 역할적용해서 직접 다운로드 구현</p> 
<h3> <a id="3-s3로-업로드-해야할-항목은" class="anchor" href="#3-s3%EB%A1%9C-%EC%97%85%EB%A1%9C%EB%93%9C-%ED%95%B4%EC%95%BC%ED%95%A0-%ED%95%AD%EB%AA%A9%EC%9D%80" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>3) s3로 업로드 해야할 항목은..?</h3> 
<p>기존에는 ec2로 파일과,이미지 모두 올리고 있었다.</p> 
<p>그런데 이것을 S3로 파일과 이미지를 바꿔 올리려한다.</p> 
<p>현재, ec2의 경우 750시간,30GB 무료이고</p> 
<p>S3의 경우는 표준 스토리지 5GB, GET 요청 20,000건, PUT 요청 2,000건으로 트래픽에 대한 요금이 발생한다.</p> 
<p>이해할 수 없는건 벌써 S3의 경우 일주일도 안되서 30퍼센트 GET 요청이 이루어졌다.</p> 
<p>이대로 가다간 금방 과금이 발생할것만 같다. 저 정도의 요청을 하지는 않았던것 같은데..</p> 
<p>S3의 경우 트래픽에 대한 요금이 발생해 굉장히 조심스럽다..</p> 
<p>게시글의 다운로드 파일같은경우는 회원들이 클릭을 할때만 S3로 요청을 하겠지만,</p> 
<p>이미지 파일같은경우는 비회원까지 포함해서 게시글을 읽는 것만으로도 요청이 수많이 들어갈텐데</p> 
<p>그러면 이미지들은 그냥 EC2에다가 저장을 하는것이 비용문제를 줄일수 있는것일까..?</p> 
<p>현재 게시글 쓰기 페이지에서 파일과,이미지를 올릴수 있는데..</p> 
<p>문제는 이미지도 s3로 올려야 하는지 잘 모르겠다.</p> 
<p>ec2와 분리해서 s3를 사용하는 이유가 있을텐데..</p>
</body>
</html>
